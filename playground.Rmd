---
title: "Stuff"
author: "Jonas Simon Fleck"
date: "12/7/2017"
output: html_document
---

```{r}
library(Tmisc)
library(ape)
library(ggplot2)
setwd('~/Documents/Msc-Biotechnologie/masterarbeit-zeller/')
source('nile/scripts/plotting/data_new.R')

rel_counts <- binners_count_info %>% 
  filter(assembler=='LSA_55') %>%
  select(species, cluster, read_count_cluster) %>% 
  group_by(cluster, species) %>% 
  summarise(count=sum(read_count_cluster)) %>% 
  ungroup() %>% 
  group_by(cluster) %>% 
  mutate(abundance=count/sum(as.numeric(count)))

 
rel_matrix <- rel_counts %>%
  select(-count) %>%
  spread(cluster, abundance) %>%
  remove_rownames %>%
  column_to_rownames(var='species') %>%
  as.matrix() 




jsd(rel_matrix)
dist(t(rel_matrix), method='euclidean')
res <- pcoa(dist_matrix)
# 
# 
# coords <- res$vectors %>% as_tibble() %>% rownames_to_column(var = "cluster") %>% select(Axis.1, Axis.2, cluster)
# 
# coords
# 
# binners_count_info %>%
#   filter(assembler=='LSA_55') %>%
  

```
